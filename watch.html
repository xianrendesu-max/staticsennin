<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>再生</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{margin:0;background:#1e1e2f;color:#fff;font-family:sans-serif}
iframe{width:100%;height:50vw;max-height:420px}
.container{padding:1em}
.back{display:inline-block;margin:1em 0;background:#4caf50;padding:.5em 1em;color:white;text-decoration:none;border-radius:4px}
</style>
</head>

<body>
<iframe id="player" allowfullscreen></iframe>
<div class="container">
<a href="index.html" class="back">← 戻る</a>
<h2>コメント</h2>
<div id="comments">読み込み中…</div>
</div>

<script>
const COMMENTS_APIS=[
"https://siawaseok-wakame-server2.glitch.me",
"https://invidious.0011.lt",
"https://invidious.nietzospannend.nl"
];

const id=new URLSearchParams(location.search).get("id");
document.getElementById("player").src=`https://www.youtube-nocookie.com/embed/${id}`;

(async()=>{
 for(const b of COMMENTS_APIS){
  try{
   const r=await fetch(`${b}/api/v1/comments/${id}`);
   const d=await r.json();
   if(d.comments){
    document.getElementById("comments").innerHTML=
     d.comments.map(c=>`<p><b>${c.author}</b><br>${c.content}</p>`).join("");
    return;
   }
  }catch{}
 }
 document.getElementById("comments").textContent="コメント取得失敗";
})();
</script>
</body>
</html>
